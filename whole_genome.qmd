# Whole-Genome Comparison

In this part of the workshop, you will use public resources for whole-genome identification and classification of prokaryotes to help identify your isolate.

::: { .callout-important }
Please ensure that you have downloaded the genome file for your isolate (`isolate_genome.fasta`) to a suitable location on your computer.
:::

## TYGS

- Go to the [TYGS](https://tygs.dsmz.de/) server

![](assets/images/TYGS/01-tygs.png)

- Click on `Submit your query` (top menu), or `Submit your job` (button) to reach the query page

![](assets/images/TYGS/02-tygs.png)

- Click on the `Browseâ€¦` button and navigate to your `isolate_genome.fasta` file to select it for classification.
- Enter your email address in the `Provide contact details` field

![](assets/images/TYGS/03-tygs.png)

- Click on `Submit query` and wait for the results

![](assets/images/TYGS/04-tygs.png)

::: { .callout-warning }
This may take some time (maybe over an hour, depending on server load!), and may not be complete before the end of the workshop.

**Please move on to the next section while you are waiting.**
:::

- **When you get the result confirmation email, inspect the PDF** 

::: { .callout-important title="Questions"}
1. What is the predicted taxonomic classification of your isolate's genome?
2. How similar is your isolate's genome to the closest match? (the $d_4$ result is the dDDH (digital DNA-DNA hybridisation) score)
3. What is your current opinion about the identity of your isolate? How confident are you in the identification?
:::

## genomeRxiv

[`genomeRxiv`](http://genomerxiv.cs.vt.edu/) is a new appraoch that promises to identify and classify prokaryotic genomes quickly and accurately into categories called LINgroups (LIN: Life Identification Number). LINgroups are a taxonomy-independent, quantitative categorisation scheme that organises genome sequences by similarity in multidimensional "space". These categorisations can then be used to relate alternative taxonomic assignments, and other annotations, to each other (@Mazloom2022-uv).

::: { .callout-note collapse="true" }
## How `genomeRxiv` works

`genomeRxiv` works in a similar way to [map grid references](https://en.wikipedia.org/wiki/Projected_coordinate_system). 

![Example map grid references: point A has grid reference 970 (Easting) and 280 (Northing) as _x_-_y_ co-ordinates, so the total reference is 970280. Similarly, point B is at 989319, and point C at 005255. All points in the map, however large or small, are uniquely assigned to a discrete location and, by subdividing the map into smaller and smaller squares (longer and longer numbers) an arbitrary level of precision can be reached](assets/images/DarronGedge-HowToReadASixFigureGridReference-Screenshot.png)

`genomeRxiv` compares input sequences to a reference database with a very fast bioinformatics algorithm (`sourmash`) to get a set of good matches, and then refines the match with a more precise but slower algorithm (`ANI`). `genomeRxiv` then assigns a LINgroup to the genome. The LINgroup is a string of numbers, analogous to a map co-ordinate. The shorter the LINgroup, the lower the resolution of identification (Phylum, Family, etc.), and the longer the LINgroup, the finer the resolution (species, subspecies, strain, etc.).

The first key difference between LINgroups and map co-ordinates is that LINgroups are not co-ordinates on a two-dimensional surface, but in many-dimensional space. The second is that a single number describes the location, rather than two numbers (the "Easting" and "Northing" of map co-ordinates. Finally, grid references represent a physical space (such as the surface of the Earth), and LINgroups represent "sequence space" - which is not physical (@Mazloom2022-uv).

Taxa are then defined by the volumes in space circumscribed by genomes which are examples of each taxon. When a new unknown genome is added, a LINgroup is assigned and - if it lies within a volume of space contained only by members of a single taxon (e.g. _E. coli_), the genome is assigned that taxon. 
:::

The [`genomeRxiv` webservice](http://genomerxiv.cs.vt.edu/)  allows users to input their bacterial genomes and rapidly obtain, or predict, taxonomic assignments on the basis of genome sequence.

::: { .callout-warning }
`genomeRxiv` remains under active development and is not yet fully-released, although it is public and usable.
:::

- Go to the [genomeRxiv](http://genomerxiv.cs.vt.edu/) server

![](assets/images/genomeRxiv/01-genomeRxiv.png)
- Click on `Identify using a FASTA file`

![](assets/images/genomeRxiv/02-genomeRxiv.png)

- Either click on the `Sequence to be identified` link to bring up a dialogue box through which you can upload the `isolate_genome.fasta` file, or drag the `isolate_genome.fasta` file onto the text.
- Click on `Identify` and wait for the results

::: { .callout-note }
The genomeRxiv site may ask you to allow pop-ups. You should allow the pop-ups, as these contain the identification output you need.
:::
  
::: { .callout-important title="Questions"}
1. What is the predicted taxonomic classification of your isolate's genome? (Check the `Member LINgroups` result)
2. What is the taxonomic identity assigned to the most similar genome in the database?
3. How similar is your isolate's genome to the closest match? (Look at the `ANI to Target` value)
4. What is your current opinion about the identity of your isolate? Have you modified your classification? How confident are you in the identification?
:::

::: { .callout-tip title="Consider your final evaluation"}
You have now used a number of different online bioinformatics tools to obtain a possible taxonomic classification for the isolate in your blood sample. You should, by this point, have some idea of what you think the organism is, and how confident you are. Now it's time to take a look at the official prokaryotic nomenclature database, to get a little more context around the candidate taxonomic name. Click on the link to [`LPSN`](lpsn.qmd) (here, or below), to keep going.
:::